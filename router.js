!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("array-flatten"),require("path-to-regexp"));else if("function"==typeof define&&define.amd)define(["array-flatten","path-to-regexp"],e);else{var r="object"==typeof exports?e(require("array-flatten"),require("path-to-regexp")):e(t["array-flatten"],t["path-to-regexp"]);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,function(t,e){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){return"/"!==t&&(t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("/")||(t="/"+t)),t}var o=r(6),i=r(3),s=r(7),u=t.exports=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";if("string"!=typeof e)throw new TypeError("Router.constructor() requires prefix to be a string");return this instanceof t?(this.prefix=n(e),this.routes=[],this.routeIdx,this.end=function(){},this):new t(e)};i.concat("all").forEach(function(t){u.prototype[t]=function(e){for(var r=arguments.length,i=Array(r>1?r-1:0),u=1;u<r;u++)i[u-1]=arguments[u];if(i=o(i),"string"!=typeof e)throw new TypeError("Router."+t+"() requires a path as the first parameter");if(!i.length)throw new TypeError("Router."+t+"() requires at least one function");if(!i.every(function(t){return"function"==typeof t}))throw new TypeError("Router."+t+'() requires middlewares to be of type "function"');e=n(e);var h=new s(this,t,e);return h.setHandlers(i),this.routes.push(h),this}}),u.prototype.use=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];e=o(e);var i="string"==typeof e[0]?n(e.shift()):"/";if(!e.length)throw new TypeError("Router.use() requires middleware functions");if(!e.every(function(t){return"function"==typeof t}))throw new TypeError('Router.use() requires middlewares to be of type "function"');var u=new s(this,"use",i,{end:!1});u.setHandlers(e),this.routes.push(u)},u.prototype.handle=function(t,e,r){function n(){if(o.routeIdx>=o.routes.length)return o.end(t,e);var r=o.routes[o.routeIdx],i=r.match(t.method,t.path);return o.routeIdx++,i?void r.handle(t,e,n):n()}var o=this;this.routeIdx=0,n()},u.prototype.setPrefix=function(t){this.prefix=n(t)},u.prototype.debug=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={prefix:this.prefix,routes:this.routes.map(function(t){return t.debug()})};return t?JSON.stringify(e):e},u.prototype.middleware=function(){function t(t,r,n){return e(t,r,n)}var e=this.handle.bind(this);return t.debug=this.debug.bind(this),t.setPrefix=this.setPrefix.bind(this),t}},,,function(t,e){"use strict";t.exports=["get","post","put","delete"]},,,function(e,r){e.exports=t},function(t,e,r){"use strict";function n(t,e){return e=e||{},function(r,n){var o=t(),s=[];n=n||{};var u=i(o,s,e),h=u.exec(r);if(null===h)return!1;var a=h.shift();return s.forEach(function(t,e){n[t.name]=h[e]}),{match:a,params:n}}}function o(t,e){return"/"===t?e:(e.endsWith("/")&&(e=e.slice(0,-1)),""+e+t)}var i=r(8),s=r(3),u=r(9),h=t.exports=function(t,e,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if("Router"!==t.constructor.name)throw new TypeError("Route.constructor() expects router to be an instance of Router");if(!s.concat(["all","use"]).includes(e))throw new TypeError("Route.constructor() method argument is invalid");if("string"!=typeof r)throw new TypeError("Route.constructor() requires path to be a string");return this.router=t,this.method=e,this.path=r,this.params={},this.matchingUrl,this.pathMatcher=n(this.getPath.bind(this),o),this.handlers=[],this.handlerIdx,this};h.prototype.getPath=function(){return o(this.path,this.router.prefix)},h.prototype.setHandlers=function(t){var e=this;this.handlers=t.map(function(r,n){var o=n===t.length-1&&r.length<3?"callback":"middleware";if(r.hasOwnProperty("setPrefix")){if("use"!==e.method)throw new Error("Router.setHandlers() can only accept a router-as-middleware only when created by .use()");r.getRoutePrefix=e.getPath.bind(e)}return new u(o,r)})},h.prototype.match=function(t,e){if(this.method!==t&&"all"!==this.method&&"use"!==this.method)return!1;var r=this.pathMatcher(e);return r!==!1&&(this.matchingUrl=r.match,this.params=r.params,!0)},h.prototype.handle=function(t,e,r){function n(i){if("route"===i)return r();if(o.handlerIdx>=o.handlers.length)return r();var s=o.handlers[o.handlerIdx];o.handlerIdx++,e.next=n,s.run(t,e,n)}t.params=this.params,this.handlerIdx=0;var o=this;n()},h.prototype.debug=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={path:this.getPath(),method:this.method,handlers:this.handlers.map(function(t){return t.debug()})};return t?JSON.stringify(e):e}},function(t,r){t.exports=e},function(t,e){"use strict";var r=t.exports=function(t,e){if("string"!=typeof t)throw new TypeError("Handler.constructor() requires type to be a string");if("function"!=typeof e)throw new TypeError("Handler.constructor() requires handler to be of type function");return this.type="routerAsMiddleware"===e.name?"router":t,this.handler=e,this};r.prototype.debug=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setPrefix();var e=void 0;return e="router"===this.type?this.handler.debug():{type:this.type,name:this.handler.name||"<anonymous>",arguments:this.handler.length},t?JSON.stringify(e):e},r.prototype.run=function(t,e,r){this.setPrefix(),this.handler(t,e,r)},r.prototype.setPrefix=function(){"router"===this.type&&this.handler.hasOwnProperty("setPrefix")&&this.handler.hasOwnProperty("getRoutePrefix")&&this.handler.setPrefix(this.handler.getRoutePrefix())}}])});